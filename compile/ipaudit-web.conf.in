#
#  Configuration file for Ipaudit-Web
#
#  Make changes according to numbered comments below.  Make sure
#  that there are NO SPACES on either side of equals sign (=)
#
#  This config file is read by the following files
#     ~/cron/cron30min
#     ~/cron/crondaily
#     ~/cron/cronweekly
#     ~/cron/cronclean
#     ~/reports/30min/0traffic/runcron
#     ~/reports/30min/graphic/runcron
#     ~/reports/daily/server/runcron
#     ~/reports/daily/server/runcron
#     ~/reports/daily/traffic/runcron
#     ~/reports/weekly/traffic/runcron
#     ~/reports/monthly/traffic/runcron
#     ~/reports/30min/0traffic/MakeReport30
#     ~/ipaudit_config.pm
#
#  --------------------------------
#  REQUIRED CHANGES
#  --------------------------------
#
#
#  (1)  What is your network?  Put something like
#       "137.99" or "24.50.17"
#
#       With multiple networks, use something like
#       "204.253.208.0/21:206.66.128.0/21:206.136.16.0/20"
#
#       DO NOT use the default.  For more information
#       see ipaudit man pages.  Also see 'OTHERRANGE' below.
#       (try 'man ipaudit' or 'man -Mman ipaudit')
#
LOCALRANGE=127.0.0
#
#
#  (2) This is the interface whose traffic you
#      wish to monitor.  The default below is 'eth0'.
#      You can monitor multiple interfaces using something
#      like 'eth0:eth1:eth3'
#     
#
#  Ethernet interface to watch (cron30min)
#
INTERFACE=eth0
#
#
#  (3)  We need to know where to find these utilties
#          gzip
#          zcat  
#          zgrep
#          gnuplot
#       if unsure, try running the command 'which gzip', etc
#       to find out.
# 
#
# These next five are edited automagically by configure.
AWK=@AWK@
GZIP=@GZIP@
ZCAT=@ZCAT@
ZGREP=@ZGREP@
GNUPLOT="nice -19 @GNUPLOT@"
#
#
#  (4)  Location of ipaudit cgi-bin directory as expressed 
#       in URL.  Default is '/cgi-bin/ipaudit'.
#
#  CGI directory as encoded within web page (MakeReportDaily)
#
CGI_BIN=/~ipaudit/cgi-bin
#
#
#   (5) Where is the ipaudit-web home directory? This is primarily
#       referenced by the CGI scripts via ipaudit_config.pm.
#
# This is also automagically generated by configure.
IP_DIR=@IPA_HOMEDIR@
#
#  --------------------------------
#  OPTIONAL CHANGES
#  --------------------------------
#
#  (6) (optional)  The default "500000,100000" is probably ok.
#      For more info, see 'man ipaudit' for the -L option.
#
#  Maximum number of packets recorded in time interval
#  Helps prevent oversized dump files and memory overflow
#  at risk of incomplete data gathering.
#
HostPortLimit="500000,100000"
#
#  When using 'HostPortLimit' the following ip addresses are
#  used a stand-ins for local/remote addresses when the hostport
#  limit is reached.  In the following example, the replacement
#  local and remote addresses are 137.99.0.0 and 0.0.0.1
#  For your installation, use a pair of addresses that will
#  be classfied as local and remote according to your LOCALRANGE
#  and optional OTHERRANGE.
#
# overflowip=137.99.0.0,0.0.0.1
#
#  (7) (optional)  Do you want to save raw packets?
#
#      By default no raw packets are saved.  If you set
#         SAVEFILE=default.raw
#      then the first PacketLen bytes (see PacketLen below)
#      of each packet will be stored in the raw/30min/
#      directory in files names like 2001-11-29-13:30.raw.gz
#     
#      You can save only certain protocol/ports with the 
#      option saveport.  See 'man ipaudit' -p option for
#      details of the format.  Below are a few examples.
#
#  Example: to save all packets
#      SAVEFILE=default.raw
#  Example: to save telnet, ftp (tcp protocol=6, ports=21,23)
#      SAVEFILE=default.raw
#      saveport=6,21,23
#  Example: to save ICMP and telnet, ftp
#      SAVEFILE=1:6,21,23
#
#  NOTE - SAVEFILE _must_ be all uppercase
#
#
#   (8) (optional)  File ages - controls how long data
#       files hang around until they are erased.
#       Defaults are built into ~/cron/cronclean and
#       are 7, 30 and 60 days, same as comments lines
#
#  RAW_DAY - how many days for raw packet data files
#  DATA_DAY - how many days for ipaudit summary data
#  HTML_DAY - how many days for html reports
#
RAW_DAY=7
DATA_DAY=10
HTML_DAY=180
#
#   (9) (optional)  Graph Limits - sets maximum Y value
#       for graphs
#
#YMAX_TRAFFIC=
#YMAX_LOCAL=15000
#YMAX_REMOTE=150000
#YMAX_REMOTE=60000
#
#  These probably don't need changing (?).  Consult
#  'man ipaudit' for more information on these options.
#
PidFile=run/ipaudit.pid
WriteTime=yes
IcmpType=yes
PacketLen=128
WritePacketLimit=500000
#
#  When tabulating the Daily Traffic report - in particular
#  the host and host-pair total byte counts - the limits below
#  specify the mininum number of bytes each host or host-pair
#  must have.  
#  a host or a 
#  Below are the minimum number of incoming + outgoing bytes 
#  that a host Vor a host-pair can 

#
# When tabulating the Daily Remote Host Traffic report it can
# require excessive amounts of memory (in other words, your
# system's memory might be exceeded) to store *every* remote
# host.  The same applies to the Daily Host Pair report when
# storing *every* host pair.  Since the report only prints the
# Top N hosts, it does not need to know every host, only those
# hosts most like to make the Top N hosts.  To address this
# problem a maximum of 100,000 remote hosts (and host-pairs) are kept in memory
# at one time.  When this limit is exceeded the oldest hosts
# (and host-pairs) are discarded unless there totla traffic
# exceeds the minimums set below.  
#
# You can probably leave these limits alone.
#
DAILY_TRAFFIC_REMOTEHOST_MIN=1024
DAILY_TRAFFIC_HOSTPAIR_MIN=1024
#
#  Set the maximum number of local hosts, remote hosts and host pairs
#  set in the 30min Traffic report.  This help prevent excessive memory
#  usage if there are an excessive number of hosts or host pairs.
MAX_REMOTE_HOST_CNT=500000
MAX_LOCAL_HOST_CNT=100000
MAX_HOST_PAIR_CNT=1000000
#
#  Do you have a range of IP address which you want to treat as
#  neither local nor remote?  Configure that address range here
#  as 'other' addresses.  When assigned ip addresses to a
#  range the 'local' network range takes precedence, then the
#  'other' network range.  Addresses which match neither are
#  assigned 'remote'.  The following value sets all multicast
#  traffic as 'other'.
OTHERRANGE=224.0.0.0/8
